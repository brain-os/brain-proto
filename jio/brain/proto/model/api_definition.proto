syntax = "proto3";

package jio.brain.proto.model;

import "google/protobuf/timestamp.proto";
import "jio/brain/proto/model/model_enums.proto";
import "jio/brain/proto/model/api_definition_testcases.proto";
import "jio/brain/proto/model/api_definition_field_descriptors.proto";

option java_package = "com.jio.brain.proto.model";
option java_outer_classname = "ApiDefinitionProto";
option java_multiple_files = true;



//                       1:1                                   
// ApiDefintion   ------------------->   ApiDefinitionDetails 
//     |                                      |               
//     +--  api_id                            | 1:N                                           
//     |                                      +------ Api Input Fields                        
//     +--  enabled/disabled                  | 1:N                                           
//     |                                      +------ Api Output Fields
//     +-- created/modifiedAt                 |
//                                            +------ HealthCheckTests
//                                            |
//                                            +------ BenchmarkingTests
//                                            |
//                                            +------ Code Snippets
//                                            |
//                                            +---- name/description/tags/domain/dataTypes/apiType


/**
 * Represents an API Definition. 
 * 
 * This message is just a wrapper over ApiDefinitionDetails message
 * and contains status of the API (Enabled or not). Disabled APIs 
 * should not be allowed to have their implementations onboarded
 * and invoked. 
 *
 */
message ApiDefinition {
    uint32                      api_id                      = 1;
    ApiDefinitionDetails        api_definition_details      = 2;
    bool                        enabled                     = 3;    // If disabled then adding/consuming impl will NOT be allowed
    google.protobuf.Timestamp   created_at                  = 4;
    google.protobuf.Timestamp   last_modified_at            = 5;
}




message ApiDefinitionDetails {
                string                      api_id_ext                  = 1;    // Unique (Human Readable ID) of an API Definition
    
                string                      api_name                    = 2;    // Name of the API. Example Sentiment Analysis
                string                      api_description             = 3;    // Brief Description of the API Definition 

    repeated    ApiInputFieldDescriptor     input_field_descriptors     = 4;    // Input Fields of the API Definition
    repeated    ApiOutputFieldDescriptor    output_field_descriptors    = 5;    // Output Fields of the API Definition            
    
                HealthCheckTestCases        health_check_tests          = 6;    // Basic Tests to run on any model during onboarding to ensure bare minimum quality 
                ApiBenchmarkingTestCases    benchmarking_tests          = 7;    

                ApiType                     api_type                    = 8;    
                ApiDataType                 api_input_data_type         = 9;    
                ApiDataType                 api_output_data_type        = 10;    
    repeated    ApiDomain                   api_domains                 = 11;    // Domains in which this API is applicable        
    repeated    string                      api_tags                    = 12;    // Tags by which this API definition can be searched against
                map<string, CodeSnippet>    invocation_code_snippets    = 13;    // Map of Programming Language -> Example Code Snippet for Invoking the API 
}








message ApiDefinitionIdentity {
    oneof id_oneof {
        uint32      api_id           = 1;
        string      api_id_ext       = 2;
    }

}



message CodeSnippet {
    string      code_snippet        = 1;
}